<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<script src="js/rem.js" type="text/javascript" charset="utf-8"></script>
		<title></title>
		<link rel="stylesheet" type="text/css" href="css/shangpinliebiao.css"/>
		<link rel="stylesheet" type="text/css" href="css/bug.css" />
		<script src="js/vue.js" type="text/javascript" charset="utf-8"></script>
	</head>

	<body>
		<div class="wrapper">
			<div class="header header02">
				<div class="aside mui-action-back">
					<img src="img/youjian.png" class="back" />
				</div>
				<div class="head-main" style="background: none;">
					分类
				</div>
				<div class="aside"></div>
			</div>
			<div class="main" style="height: calc(100% - .96rem);">
				<div class="nav02">
					<div class="nav-tab" @click="nav01show">
						<span>{{goodsTypename}}</span>
						<img src="img/Arrow_up.png" />
					</div>
					<div class="nav-tab" @click="nav02show">
						<span>{{regionname}}</span>
						<img src="img/Arrow_up.png" />
					</div>
					<div class="nav-tab" @click="nav03show">
						<span>{{marketIdname}}</span>
						<img src="img/Arrow_up.png" />
					</div>
					<div class="nav-tab" @click="nav04show">
						<span>{{goodsType2name}}</span>
						<img src="img/Arrow_up.png" />
					</div>
				</div>
				<div class="adver-main">
					<div class="main-one" v-for='val in navdata' @click="openshop(val.smMerchantId)">
						<div class="one-lift">
							<img :src="val.smMeShopImg" />
						</div>
						<div class="one-right">
							<div class="one-text">{{val.smMeShopName}}</div>
							<div class="one-news">{{val.smMeAddress}}</div>			
						</div>
					</div>
				</div>
				<!--选择行业-->
				<div class="botton-nav" v-show="nav01boo" @click="nav01show">
					<div class="bottom-main">
						<div class="bottom-tab" @click="changenav01('','全部行业')" :class="goodsTypeid==''?'active02':''">
							全部行业
						</div>
						<div class="bottom-tab" v-for="val in nav01" @click="changenav01(val.smShopTypeId,val.smStName)" :class="goodsTypeid==val.smShopTypeId?'active02':''">
							{{val.smStName}}
						</div>
					</div>
				</div>
				<!--选择地区-->
				<div class="botton-nav adresschange" v-show="nav02boo" @click="nav02show">
					<div class="bottom-main">
						<div class="left">
							<div class="left-tab" @click="change(val.smAdvertisementAddressId,val.smAaArea)" v-for="(val,index) in adressdata" :class="index==myindex?'active':''">
								<span>
									{{val.smAaProvice}}{{val.smAaCity}}{{val.smAaArea}}
								</span>
							</div>
						</div>
					</div>
				</div>
				<!--全部市场-->
				<div class="botton-nav" v-show="nav03boo" @click="nav03show">
					<div class="bottom-main">
						<div class="bottom-tab" @click="changenav03('','全部市场')" :class="marketIdid==''?'active02':''">
							全部市场
						</div>
						<div class="bottom-tab" v-for="val in nav03" @click="changenav03(val.smAdvertisementMarketId,val.smAmName)" :class="marketIdid==val.smAdvertisementMarketId?'active02':''">
							{{val.smAmName}}
						</div>
					</div>
				</div>
				<!--二级行业-->
				<div class="botton-nav" v-show="nav04boo" @click="nav04show">
					<div class="bottom-main">
						<div class="bottom-tab" @click="changenav04('','全部分类')" :class="goodsType2id==''?'active02':''">
							全部分类
						</div>
						<div class="bottom-tab" v-for="val in nav04" @click="changenav04(val.smShopTypeId,val.smStName)" :class="goodsType2id==val.smShopTypeId?'active02':''">
							{{val.smStName}}
						</div>
					</div>
				</div>
			</div>
		</div>
	</body>
	<script src="js/mui.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/URL.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
		new Vue({
			el: '.wrapper',
			data: {
				goodsTypename: '全部行业',
				goodsTypeid: '',
				goodsType2name: '全部分类',
				goodsType2id: '',
				regionname: '全部地区',
				regionId: '',
				marketIdname: '全部市场',
				marketIdid: '',
				adressdata: '',
				myindex: 0,
				subindex: 0,
				navdata: [],
				navdata02: [],
				nav01: [],
				nav01boo: false,
				nav02: [],
				nav02boo: false,
				nav03: [],
				nav03boo: false,
				nav04: [],
				nav04boo: false
			},
			methods: {
				openshop: function(id) {
					localStorage.setItem('storeinfoid', id)
					mui.openWindow({
						url: './store.html',
						id: 'store'
					})
				},
				nav04show: function() {
					if(this.goodsTypeid != '') {
						this.nav04boo = !this.nav04boo
						this.myajax()
					} else {
						plus.nativeUI.toast('请先选择所属行业')
					}

				},
				changenav04: function(id, name) {
					this.goodsType2id = id
					this.goodsType2name = name
					this.myajax()
				},
				changenav03: function(id, name) {
					this.marketIdid = id
					this.marketIdname = name
					this.myajax()
				},
				nav01show: function() {
					this.nav01boo = !this.nav01boo
				},
				opennew: function(target) {
					mui.openWindow({
						url: './' + target + '.html',
						id: target,
						createNew: true
					})
				},
				changenav01: function(id, name) {
					this.goodsTypeid = id
					this.goodsTypename = name
					this.myajax()
				},
				nav02show: function() {
					this.nav02boo = !this.nav02boo
				},
				change: function(id, name) {
					this.regionId = id
					this.regionname = name
					this.myajax()
				},
				nav03show: function() {
					this.nav03boo = !this.nav03boo
				},
				myajax: function() {
					var that = this
					//					获取广告列表
					var ajaxjson = {
						smStPpid: that.goodsTypeid, //一级分类id
						smShopTypeId: that.goodsType2id, //二级分类id
						smAdvertisementAddressId: that.regionId, //地址id
						smAdvertisementMarketId: that.marketIdid //市场Id
					}
					if(that.goodsType2id != '') {
						ajaxjson.smStPpid = ''
					}
					$.ajax({
						type: "post",
						url: myurl + "/user/selectSmMerchantSmShopType",
						dataType: 'json',
						data: ajaxjson,
						success: function(res) {
							that.navdata = res.data
						}
					});

					//					获取一级分类
					$.ajax({
						type: "get",
						url: myurl + "/user/selectSmShopTypeOne",
						dataType: 'json',
						success: function(res) {
							that.nav01 = res.data
							//					获取二级分类
							$.ajax({
								type: "post",
								url: myurl + "/user/selectSmShopTypeTwo",
								dataType: 'json',
								data: {
									smStPpid: res.data[0].smShopTypeId
								},
								success: function(res) {
									that.nav04 = res.data
								}
							});
						}
					});

					//					获取地区
					$.ajax({
						type: "POST",
						url: myurl + '/user/selectSmAdvertisementAddress',
						datatype: 'json',
						success: function(res) {
							that.adressdata = res.data
						}
					});
					//					获取市场
					$.ajax({
						type: "post",
						url: myurl + "/user/selectSmAdvertisementMarket",
						dataType: 'json',
						data: {
							regionId: localStorage.getItem('adressid')
						},
						success: function(res) {
							that.nav03 = res.data
						}
					});
				}
			},
			mounted: function() {
				this.myajax()
			},
			updated: function() {

			}
		})
	</script>

</html>